<!DOCTYPE html>
<html>
<head>
    <title>WebSocket Test</title>
</head>
<body>
    <div id="messages"></div>
    <script>
        const socket = new WebSocket('ws://localhost:8080/ws');
        const messages = document.getElementById('messages');
        
        socket.onopen = function(event) {
            addMessage('WebSocket connection opened');
            
            // Join chat room
            const joinMessage = {
                senderId: 'john_doe',
                content: '',
                chatRoomId: 'public',
                type: 'JOIN'
            };
            socket.send(JSON.stringify(joinMessage));
        };
        
        socket.onmessage = function(event) {
            const message = JSON.parse(event.data);
            addMessage('Received: ' + JSON.stringify(message));
        };
        
        socket.onclose = function(event) {
            addMessage('WebSocket connection closed');
        };
        
        function addMessage(text) {
            const messageElement = document.createElement('div');
            messageElement.textContent = text;
            messages.appendChild(messageElement);
        }
        
        // Send a test message after 2 seconds
        setTimeout(() => {
            const chatMessage = {
                senderId: 'john_doe',
                content: 'Hello from WebSocket!',
                chatRoomId: 'public',
                type: 'CHAT'
            };
            socket.send(JSON.stringify(chatMessage));
            addMessage('Sent: ' + JSON.stringify(chatMessage));
        }, 2000);
    </script>
</body>
</html>